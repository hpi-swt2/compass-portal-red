<% content_for :title, @params ? "Results for #{@params}" : "Search" %>

<% # show clear button on entered text %>
<script type="text/javascript" charset="utf-8">
    function textEntered(field) {
        if (!field) {
            field = document.getElementById("search");
        }
        const btn = document.getElementById("cancel");
        if (field.value === "") {
            btn.style.visibility = "hidden";
        } else {
            btn.style.visibility = "visible";
        }
    }
</script>

<body onload="textEntered();">
  <div class="row">
    <div class="col-lg-6 col-md-9 col-12 mx-auto">
      <%= form_with url: search_path, method: :get do |form| %>
        <div class="row align-items-end mb-3">
          <div class="col">
            <div class="form-group">
              <%= form.text_field :query, class: "form-control", autofocus: true, value: @params, id: "search", oninput: "textEntered(this)" %>
              <%= button_to "X", { action: "index" }, class: "cancel-input", id: "cancel" %>
            </div>
          </div>
        </div>
      <% end %>
      <div class="row">
        <div class="col">
          <div class="list-group" id="exact-results">
            <% if @exact_results.present? %>
              <% @exact_results.each do |result| %>
                <a href="<%= url_for(result) %>" class="list-group-item list-group-item-action">
                  <span class="<%= result.icon_class %>"></span>
                  <%= result.to_string %>
                </a>
              <% end %>
            <% end %>
          </div>
          <% if @exact_results.present? and @more_results.present? %> More Results
          <% end %>
          <div class="list-group" id="more-results">
            <% if @more_results.present? %>
              <% @more_results.each do |result| %>
                <a href="<%= url_for(result) %>" class="list-group-item list-group-item-action search-item">
                  <span class="<%= result.icon_class %>"></span>
                  <%= result.to_string %></a>
              <% end %>
            <% end %>
          </div>
        </div>
      </div>
    </div>
  </div>
</body>
